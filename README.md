# üè¢ Sistema de Administraci√≥n de Condominios

![Django](https://img.shields.io/badge/django-%23092E20.svg?style=for-the-badge&logo=django&logoColor=white)
![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54)
![SQLite](https://img.shields.io/badge/sqlite-%2307405e.svg?style=for-the-badge&logo=sqlite&logoColor=white)
![Bootstrap](https://img.shields.io/badge/bootstrap-%23563D7C.svg?style=for-the-badge&logo=bootstrap&logoColor=white)

**Torre Segura** - Sistema web desarrollado con Django para la administraci√≥n integral de condominios verticales (edificios). Soluci√≥n completa que incluye gesti√≥n de residentes, control de accesos, m√≥dulo financiero y sistema de reportes avanzado.

---

## üåü Caracter√≠sticas Principales

### üë• Gesti√≥n de Usuarios y Roles
- üîê Control de acceso basado en roles (Administrador, Vigilante, Residente, Gerente)
- üë§ Perfiles personalizados por tipo de usuario
- üîÑ Sistema de cambio de roles din√°mico
- üåê **Autenticaci√≥n con Google** integrada

### üè† Gesti√≥n de Viviendas
- üè¢ Administraci√≥n de edificios y sus caracter√≠sticas
- üè† Gesti√≥n completa de departamentos/viviendas
- üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Registro detallado de propietarios e inquilinos
- üìä Estados de vivienda (ocupada, vac√≠a, en mantenimiento)

### üö™ Control de Accesos
- ‚è∞ Registro de entradas y salidas en tiempo real
- üë• Control de visitantes con datos completos
- üöó Registro de veh√≠culos residentes y de visita
- üì± Interface optimizada para vigilantes

### üí∞ M√≥dulo Financiero (¬°NUEVO!)
- üßæ Gesti√≥n de cuotas de mantenimiento
- üìà Control de pagos y estados financieros
- üîî Sistema de notificaciones de vencimientos
- üìä Reportes financieros detallados
- üí≥ Manejo de m√∫ltiples tipos de pago

### üìä Sistema de Reportes Avanzado
- üìà Generaci√≥n de reportes din√°micos con filtros
- üìÑ Exportaci√≥n m√∫ltiple: PDF, Excel, CSV, HTML
- üìâ Gr√°ficos interactivos y dashboards
- üîç Filtros personalizables por m√≥dulo

---

## üíª Requisitos del Sistema

### Software Requerido
- **Python**: 3.10+ (recomendado: 3.12.x)
- **Django**: 4.2+
- **Node.js**: (opcional, para desarrollo de frontend)
- **Git**: Para control de versiones

### Dependencias Principales
- Django AllAuth (autenticaci√≥n con Google)
- WeasyPrint (generaci√≥n de PDFs)
- Pillow (manejo de im√°genes)
- django-crispy-forms (formularios estilizados)
- python-decouple (variables de entorno)

---

## üöÄ Instalaci√≥n R√°pida

### 1. Clonar el Repositorio
```bash
git clone https://github.com/Avillegasa/pilinmaster.git
cd pilinmaster/condominio_app
```

### 2. Configurar Entorno Virtual
```bash
# Crear entorno virtual
python -m venv venv

# Activar entorno virtual
# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate
```

### 3. Instalar Dependencias
```bash
pip install -r requirements.txt
```

### 4. Configuraci√≥n de Base de Datos
```bash
# Crear migraciones
python manage.py makemigrations

# Aplicar migraciones
python manage.py migrate

# Cargar datos iniciales
python scripts/setup.py
```

### 5. Crear Superusuario
```bash
python manage.py createsuperuser
```

### 6. Iniciar Servidor de Desarrollo
```bash
python manage.py runserver
```

**üåê Acceder al sistema**: http://127.0.0.1:8000/

---

## üë§ Usuarios por Defecto

El script de configuraci√≥n crea los siguientes usuarios de prueba:

| üë§ Usuario    | üîë Contrase√±a | üé≠ Rol          | üìß Email                    |
|---------------|---------------|-----------------|----------------------------|
| admin         | admin123      | Administrador   | admin@torresegura.com      |
| vigilante     | vigilante123  | Vigilante       | vigilante@torresegura.com  |
| gerente       | gerente123    | Gerente         | gerente@torresegura.com    |
| carlos        | carlos123     | Residente       | carlos@torresegura.com     |
| maria         | maria123      | Residente       | maria@torresegura.com      |
| jorge         | jorge123      | Residente       | jorge@torresegura.com      |

> **üí° Importante**: Cambia estas contrase√±as antes del despliegue en producci√≥n.

---

## üìÅ Estructura del Proyecto

```
condominio_app/
‚îÇ
‚îú‚îÄ‚îÄ üìÅ condominio_app/           # Configuraci√≥n principal del proyecto
‚îÇ   ‚îú‚îÄ‚îÄ settings.py              # Configuraciones del proyecto
‚îÇ   ‚îú‚îÄ‚îÄ urls.py                  # URLs principales
‚îÇ   ‚îî‚îÄ‚îÄ wsgi.py                  # Configuraci√≥n WSGI
‚îÇ
‚îú‚îÄ‚îÄ üìÅ usuarios/                 # üë• Gesti√≥n de usuarios y roles
‚îÇ   ‚îú‚îÄ‚îÄ models.py                # Modelos de usuario y perfiles
‚îÇ   ‚îú‚îÄ‚îÄ views.py                 # Vistas de autenticaci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ adapters.py              # Adaptadores para OAuth
‚îÇ
‚îú‚îÄ‚îÄ üìÅ viviendas/                # üè† Gesti√≥n de edificios y viviendas
‚îÇ   ‚îú‚îÄ‚îÄ models.py                # Modelos de edificios y residentes
‚îÇ   ‚îú‚îÄ‚îÄ views.py                 # Vistas de gesti√≥n
‚îÇ   ‚îî‚îÄ‚îÄ admin.py                 # Configuraci√≥n del admin
‚îÇ
‚îú‚îÄ‚îÄ üìÅ accesos/                  # üö™ Control de entradas y salidas
‚îÇ   ‚îú‚îÄ‚îÄ models.py                # Modelos de acceso y visitas
‚îÇ   ‚îú‚îÄ‚îÄ views.py                 # Vistas de control
‚îÇ   ‚îî‚îÄ‚îÄ forms.py                 # Formularios de registro
‚îÇ
‚îú‚îÄ‚îÄ üìÅ financiero/               # üí∞ M√≥dulo financiero (NUEVO)
‚îÇ   ‚îú‚îÄ‚îÄ models.py                # Modelos de pagos y cuotas
‚îÇ   ‚îú‚îÄ‚îÄ views.py                 # Vistas financieras
‚îÇ   ‚îú‚îÄ‚îÄ forms.py                 # Formularios de pago
‚îÇ   ‚îî‚îÄ‚îÄ utils.py                 # Utilidades de c√°lculo
‚îÇ
‚îú‚îÄ‚îÄ üìÅ reportes/                 # üìä Sistema de reportes
‚îÇ   ‚îú‚îÄ‚îÄ models.py                # Modelos de reportes
‚îÇ   ‚îú‚îÄ‚îÄ views.py                 # Vistas de generaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ utils.py                 # Utilidades para reportes
‚îÇ   ‚îî‚îÄ‚îÄ templatetags/            # Filtros personalizados
‚îÇ
‚îú‚îÄ‚îÄ üìÅ templates/                # üé® Plantillas HTML
‚îÇ   ‚îú‚îÄ‚îÄ base/                    # Plantillas base
‚îÇ   ‚îú‚îÄ‚îÄ usuarios/                # Templates de usuarios
‚îÇ   ‚îú‚îÄ‚îÄ viviendas/               # Templates de viviendas
‚îÇ   ‚îú‚îÄ‚îÄ accesos/                 # Templates de accesos
‚îÇ   ‚îú‚îÄ‚îÄ financiero/              # Templates financieros
‚îÇ   ‚îî‚îÄ‚îÄ reportes/                # Templates de reportes
‚îÇ
‚îú‚îÄ‚îÄ üìÅ static/                   # üé® Archivos est√°ticos
‚îÇ   ‚îú‚îÄ‚îÄ css/                     # Estilos CSS personalizados
‚îÇ   ‚îú‚îÄ‚îÄ js/                      # JavaScript personalizado
‚îÇ   ‚îî‚îÄ‚îÄ img/                     # Im√°genes del sistema
‚îÇ
‚îú‚îÄ‚îÄ üìÅ media/                    # üìÇ Archivos subidos
‚îÇ   ‚îú‚îÄ‚îÄ profiles/                # Fotos de perfil
‚îÇ   ‚îî‚îÄ‚îÄ documents/               # Documentos varios
‚îÇ
‚îú‚îÄ‚îÄ üìÅ scripts/                  # üîß Scripts de utilidad
‚îÇ   ‚îî‚îÄ‚îÄ setup.py                 # Script de configuraci√≥n inicial
‚îÇ
‚îú‚îÄ‚îÄ manage.py                    # üöÄ Script de gesti√≥n de Django
‚îú‚îÄ‚îÄ requirements.txt             # üì¶ Dependencias del proyecto
‚îú‚îÄ‚îÄ .env.example                 # üîß Variables de entorno ejemplo
‚îî‚îÄ‚îÄ README.md                    # üìö Documentaci√≥n (este archivo)
```

---

## üîß Configuraci√≥n Avanzada

### üîê Autenticaci√≥n con Google

Para habilitar el inicio de sesi√≥n con Google:

#### 1. Crear Proyecto en Google Cloud Console

1. Ve a [Google Cloud Console](https://console.cloud.google.com/)
2. Crea un nuevo proyecto o selecciona uno existente
3. Navega a "APIs & Services" > "Credentials"
4. Crea credenciales OAuth 2.0

#### 2. Configurar URLs Autorizadas

En la configuraci√≥n de OAuth, a√±ade:

**Or√≠genes autorizados:**
```
http://localhost:8000
https://tu-dominio.com  # Para producci√≥n
```

**URIs de redirecci√≥n:**
```
http://localhost:8000/accounts/google/login/callback/
https://tu-dominio.com/accounts/google/login/callback/  # Para producci√≥n
```

#### 3. Configurar Variables de Entorno

Crea un archivo `.env` basado en `.env.example`:

```bash
# Configuraci√≥n de Google OAuth
GOOGLE_CLIENT_ID=tu-client-id-aqui
GOOGLE_SECRET=tu-secret-key-aqui

# Configuraci√≥n de base de datos
DATABASE_URL=sqlite:///db.sqlite3

# Configuraci√≥n de seguridad
SECRET_KEY=tu-secret-key-django
DEBUG=True
```

#### 4. Configurar en Django Admin

1. Accede al admin: http://localhost:8000/admin/
2. Ve a "Sites" y configura:
   - Domain: `localhost:8000` (desarrollo) o `tu-dominio.com` (producci√≥n)
   - Display name: `Torre Segura`
3. Ve a "Social Applications" y crea una nueva aplicaci√≥n:
   - Provider: Google
   - Name: Google Login
   - Client ID: (del paso 1)
   - Secret key: (del paso 1)
   - Sites: Selecciona el sitio creado

---

### üìä Configuraci√≥n de Reportes con WeasyPrint

#### Instalaci√≥n de GTK (Windows)

1. Descarga el instalador GTK desde:
   [GTK for Windows](https://github.com/tschoonj/GTK-for-Windows-Runtime-Environment-Installer/releases)

2. Instala en: `C:\Program Files\GTK3-Runtime Win64`

3. A√±ade al PATH del sistema:
   ```
   C:\Program Files\GTK3-Runtime Win64\bin
   ```

4. Reinicia tu terminal/IDE

5. Verifica la instalaci√≥n:
   ```bash
   where gobject-2.0-0.dll
   ```

#### Configuraci√≥n Alternativa para Linux

```bash
# Ubuntu/Debian
sudo apt-get install python3-dev python3-pip python3-cffi libcairo2 libpango-1.0-0 libpangocairo-1.0-0 libgdk-pixbuf2.0-0 libffi-dev shared-mime-info

# CentOS/RHEL
sudo yum install python3-devel python3-pip python3-cffi cairo pango gdk-pixbuf2
```

---

## üéØ Funcionalidades por M√≥dulo

### üë• M√≥dulo de Usuarios
- ‚úÖ Registro y autenticaci√≥n local
- ‚úÖ Integraci√≥n con Google OAuth
- ‚úÖ Gesti√≥n de perfiles por rol
- ‚úÖ Sistema de permisos granular
- ‚úÖ Cambio de contrase√±as
- ‚úÖ Recuperaci√≥n de cuentas

### üè† M√≥dulo de Viviendas
- ‚úÖ CRUD completo de edificios
- ‚úÖ Gesti√≥n de viviendas/departamentos
- ‚úÖ Registro de propietarios/inquilinos
- ‚úÖ Historial de cambios
- ‚úÖ Estados de ocupaci√≥n
- ‚úÖ B√∫squeda y filtros avanzados

### üö™ M√≥dulo de Accesos
- ‚úÖ Registro de entradas/salidas
- ‚úÖ Control de visitantes
- ‚úÖ Gesti√≥n de veh√≠culos
- ‚úÖ Notificaciones autom√°ticas
- ‚úÖ Reportes de acceso
- ‚úÖ Interface m√≥vil-friendly

### üí∞ M√≥dulo Financiero
- ‚úÖ Gesti√≥n de cuotas mensuales
- ‚úÖ Control de pagos
- ‚úÖ Estados de cuenta
- ‚úÖ Generaci√≥n de recibos
- ‚úÖ Notificaciones de vencimiento
- ‚úÖ Reportes financieros
- ‚úÖ Dashboard de ingresos

### üìä M√≥dulo de Reportes
- ‚úÖ Reportes din√°micos con filtros
- ‚úÖ Exportaci√≥n m√∫ltiple (PDF/Excel/CSV/HTML)
- ‚úÖ Gr√°ficos interactivos
- ‚úÖ Dashboards por m√≥dulo
- ‚úÖ Programaci√≥n de reportes
- ‚úÖ Plantillas personalizables

---

## üîí Configuraci√≥n de Seguridad

### Variables de Entorno Importantes

```bash
# Seguridad
SECRET_KEY=tu-clave-secreta-muy-larga-y-compleja
DEBUG=False
ALLOWED_HOSTS=localhost,127.0.0.1,tu-dominio.com

# Base de Datos
DATABASE_URL=postgresql://usuario:password@host:puerto/basededatos

# Email (para notificaciones)
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_HOST_USER=tu-email@gmail.com
EMAIL_HOST_PASSWORD=tu-app-password

# Almacenamiento en la nube (opcional)
AWS_ACCESS_KEY_ID=tu-access-key
AWS_SECRET_ACCESS_KEY=tu-secret-key
AWS_STORAGE_BUCKET_NAME=tu-bucket
```

### Configuraciones Recomendadas para Producci√≥n

```python
# settings.py para producci√≥n
SECURE_BROWSER_XSS_FILTER = True
SECURE_CONTENT_TYPE_NOSNIFF = True
X_FRAME_OPTIONS = 'DENY'
SECURE_HSTS_SECONDS = 31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS = True
SECURE_HSTS_PRELOAD = True
SESSION_COOKIE_SECURE = True
CSRF_COOKIE_SECURE = True
```

---

## üöÄ Despliegue

### Opci√≥n 1: Heroku

```bash
# Instalar Heroku CLI
# Crear archivo Procfile
echo "web: gunicorn condominio_app.wsgi" > Procfile

# Configurar Heroku
heroku create tu-app-name
heroku config:set SECRET_KEY=tu-secret-key
heroku config:set DEBUG=False
heroku addons:create heroku-postgresql:hobby-dev

# Desplegar
git push heroku main
heroku run python manage.py migrate
heroku run python scripts/setup.py
```

### Opci√≥n 2: VPS con Docker

```dockerfile
# Dockerfile
FROM python:3.12
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
EXPOSE 8000
CMD ["gunicorn", "condominio_app.wsgi:application", "--bind", "0.0.0.0:8000"]
```

```yaml
# docker-compose.yml
version: '3.8'
services:
  web:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DEBUG=False
      - SECRET_KEY=tu-secret-key
    depends_on:
      - db
  
  db:
    image: postgres:15
    environment:
      POSTGRES_DB: condominio
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```

---

## üß™ Testing

### Ejecutar Tests
```bash
# Todos los tests
python manage.py test

# Tests espec√≠ficos por app
python manage.py test usuarios
python manage.py test viviendas
python manage.py test accesos
python manage.py test financiero
python manage.py test reportes

# Tests con coverage
pip install coverage
coverage run --source='.' manage.py test
coverage report
coverage html
```

### Tests Incluidos
- ‚úÖ Tests unitarios para modelos
- ‚úÖ Tests de vistas y formularios
- ‚úÖ Tests de autenticaci√≥n
- ‚úÖ Tests de permisos
- ‚úÖ Tests de integraci√≥n

---

## ü§ù Contribuci√≥n

### Flujo de Contribuci√≥n

1. **Fork** el repositorio
2. **Crea** una rama para tu feature (`git checkout -b feature/nueva-funcionalidad`)
3. **Commit** tus cambios (`git commit -m 'Agrega nueva funcionalidad'`)
4. **Push** a la rama (`git push origin feature/nueva-funcionalidad`)
5. **Abre** un Pull Request

### Est√°ndares de C√≥digo

- **PEP 8** para Python
- **Documentaci√≥n** en espa√±ol
- **Tests** para nuevas funcionalidades
- **Variables** en espa√±ol
- **Commits** descriptivos

### Reportar Bugs

1. Verifica que el bug no est√© ya reportado
2. Crea un issue con:
   - Descripci√≥n clara del problema
   - Pasos para reproducir
   - Comportamiento esperado vs actual
   - Screenshots si es necesario
   - Informaci√≥n del entorno

---

## üìö Documentaci√≥n Adicional

### APIs Disponibles
- **REST API** para integraci√≥n m√≥vil (en desarrollo)
- **Webhooks** para notificaciones externas
- **GraphQL** endpoint (plannificado)

### Integraciones
- üì± **Aplicaci√≥n m√≥vil** (en desarrollo)
- üîî **Notificaciones push**
- üìß **Sistema de emails autom√°ticos**
- üìä **Integraci√≥n con Google Analytics**

### Roadmap
- [ ] M√≥dulo de reservas de √°reas comunes
- [ ] Sistema de tickets/soporte
- [ ] Chat interno entre residentes
- [ ] Integraci√≥n con sistemas de dom√≥tica
- [ ] App m√≥vil nativa
- [ ] Dashboard ejecutivo avanzado

---

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT. Ver el archivo [LICENSE](LICENSE) para m√°s detalles.

---

## üë®‚Äçüíª Desarrollado por

**Avillegasa** - [GitHub](https://github.com/Avillegasa)

---

## üÜò Soporte

¬øNecesitas ayuda? 

- üìß **Email**: soporte@torresegura.com
- üêõ **Reportar bug**: [Issues](https://github.com/Avillegasa/pilinmaster/issues)
- üí¨ **Discusiones**: [Discussions](https://github.com/Avillegasa/pilinmaster/discussions)
- üìñ **Wiki**: [Documentaci√≥n completa](https://github.com/Avillegasa/pilinmaster/wiki)

---

<div align="center">

### ‚≠ê Si te gusta este proyecto, ¬°dale una estrella! ‚≠ê

**Torre Segura - Sistema Integral de Gesti√≥n de Condominios**

*Desarrollado con ‚ù§Ô∏è por la comunidad*

![GitHub stars](https://img.shields.io/github/stars/Avillegasa/pilinmaster?style=social)
![GitHub forks](https://img.shields.io/github/forks/Avillegasa/pilinmaster?style=social)

</div>